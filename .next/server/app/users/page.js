(()=>{var e={};e.id=240,e.ids=[240],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},1891:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>o});var r=t(329),a=t(7868),i=t(6041),l=t.n(i),n=t(9962),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let o=["",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2367)),"C:\\Users\\IronBeast\\Desktop\\Matka\\Native Matka\\apps\\web\\app\\users\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,4321)),"C:\\Users\\IronBeast\\Desktop\\Matka\\Native Matka\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,1449)),"C:\\Users\\IronBeast\\Desktop\\Matka\\Native Matka\\apps\\web\\app\\not-found.tsx"]}],d=["C:\\Users\\IronBeast\\Desktop\\Matka\\Native Matka\\apps\\web\\app\\users\\page.tsx"],x={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},401:(e,s,t)=>{Promise.resolve().then(t.bind(t,6728))},6728:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var r=t(5697),a=t(6336),i=t(7384),l=t(3005),n=t(7403),c=t(6423),o=t(4713),d=t(7036),x=t(665),h=t(1660);function m({isOpen:e,onClose:s,user:t,onSuccess:i}){let[l,o]=(0,a.useState)(""),[m,u]=(0,a.useState)("credit"),[p,b]=(0,a.useState)(""),[j,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)(""),N=async e=>{e.preventDefault(),v(""),g(!0);try{let e=localStorage.getItem("token"),r=await fetch(`/api/users/${t?._id}/wallet`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({amount:Number(l),type:m,description:p})}),a=await r.json();if(!r.ok)throw Error(a.message||"Failed to update wallet");i(),s(),o(""),b(""),u("credit")}catch(e){v(e.message)}finally{g(!1)}};return t?(0,r.jsx)(d.Vq,{open:e,onOpenChange:s,children:(0,r.jsxs)(d.cZ,{className:"bg-surface-dark border-border-dark text-white sm:max-w-md",children:[(0,r.jsx)(d.fK,{children:(0,r.jsx)(d.$N,{children:"Manage Wallet"})}),(0,r.jsxs)("div",{className:"mb-4 p-3 bg-background-dark rounded-lg flex justify-between items-center border border-border-dark",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-text-secondary",children:"User"}),(0,r.jsx)("p",{className:"font-semibold",children:t.name}),(0,r.jsx)("p",{className:"text-xs text-text-secondary font-mono",children:t.mobile})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-xs text-text-secondary",children:"Current Balance"}),(0,r.jsxs)("p",{className:"text-xl font-bold text-primary",children:["₹ ",t.wallet_balance]})]})]}),(0,r.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(x.Label,{children:"Transaction Type"}),(0,r.jsxs)(h.E,{defaultValue:"credit",className:"flex gap-4",onValueChange:e=>u(e),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 border border-border-dark rounded-lg p-3 flex-1 cursor-pointer hover:bg-white/5 transition-colors has-[:checked]:border-success/50 has-[:checked]:bg-success/5",children:[(0,r.jsx)(h.m,{value:"credit",id:"credit",className:"text-success border-success"}),(0,r.jsx)(x.Label,{htmlFor:"credit",className:"cursor-pointer flex-1 text-success",children:"Add Money"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 border border-border-dark rounded-lg p-3 flex-1 cursor-pointer hover:bg-white/5 transition-colors has-[:checked]:border-error/50 has-[:checked]:bg-error/5",children:[(0,r.jsx)(h.m,{value:"debit",id:"debit",className:"text-error border-error"}),(0,r.jsx)(x.Label,{htmlFor:"debit",className:"cursor-pointer flex-1 text-error",children:"Deduct Money"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(x.Label,{htmlFor:"amount",children:"Amount (₹)"}),(0,r.jsx)(c.I,{id:"amount",type:"number",placeholder:"Enter amount",value:l,onChange:e=>o(e.target.value),className:"bg-background-dark border-border-dark focus:border-primary text-lg font-mono",required:!0,min:"1"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(x.Label,{htmlFor:"description",children:"Description (Optional)"}),(0,r.jsx)(c.I,{id:"description",placeholder:"Reason for adjustment",value:p,onChange:e=>b(e.target.value),className:"bg-background-dark border-border-dark focus:border-primary"})]}),f&&(0,r.jsx)("p",{className:"text-sm text-error bg-error/10 p-2 rounded border border-error/20",children:f}),(0,r.jsxs)(d.cN,{className:"mt-4",children:[(0,r.jsx)(n.z,{type:"button",variant:"ghost",onClick:s,className:"hover:bg-white/10 hover:text-white",children:"Cancel"}),(0,r.jsx)(n.z,{type:"submit",className:"credit"===m?"bg-success hover:bg-success/90 text-black font-bold":"bg-error hover:bg-error/90 text-white font-bold",disabled:j,children:j?"Processing...":"credit"===m?"Add Funds":"Deduct Funds"})]})]})]})}):null}var u=t(1191);function p(){(0,u.a)(!0);let[e,s]=(0,a.useState)([]),[t,d]=(0,a.useState)(!0),[x,h]=(0,a.useState)(""),[p,b]=(0,a.useState)(1),[j,g]=(0,a.useState)(1),[f,v]=(0,a.useState)(null),[N,y]=(0,a.useState)(!1),k=async()=>{d(!0);try{let e=new URLSearchParams({page:p.toString(),limit:"10",query:x}),t=localStorage.getItem("token"),r=await fetch(`/api/users?${e}`,{headers:{Authorization:`Bearer ${t}`}}),a=await r.json();a.success&&(s(a.data),g(a.pagination.totalPages))}catch(e){console.error("Error fetching users:",e)}finally{d(!1)}},w=async(t,r)=>{if(confirm(`Are you sure you want to ${r?"block":"activate"} this user?`))try{let a=localStorage.getItem("token"),i=await fetch(`/api/users/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({is_active:!r})}),l=await i.json();l.success?s(e.map(e=>e._id===t?{...e,is_active:!r}:e)):alert(l.message||"Failed to update status")}catch(e){console.error("Error updating status:",e),alert("An error occurred")}};return(0,r.jsxs)("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark text-white font-sans",children:[(0,r.jsx)(i.Sidebar,{}),(0,r.jsxs)("main",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:[(0,r.jsx)(l.Header,{}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4 md:p-8 pb-20",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"User Management"}),(0,r.jsx)("p",{className:"text-text-secondary",children:"Manage registered users, balances, and status."})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 bg-surface-dark p-4 rounded-xl border border-border-dark",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,r.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-text-secondary text-[20px]",children:"search"}),(0,r.jsx)(c.I,{placeholder:"Search by name or mobile...",className:"pl-10 bg-background-dark border-border-dark focus:border-primary",value:x,onChange:e=>{h(e.target.value),b(1)}})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm text-text-secondary",children:["Page ",p," of ",j]}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)(n.z,{variant:"outline",size:"icon",disabled:p<=1,onClick:()=>b(e=>e-1),className:"h-8 w-8",children:(0,r.jsx)("span",{className:"material-symbols-outlined text-[18px]",children:"chevron_left"})}),(0,r.jsx)(n.z,{variant:"outline",size:"icon",disabled:p>=j,onClick:()=>b(e=>e+1),className:"h-8 w-8",children:(0,r.jsx)("span",{className:"material-symbols-outlined text-[18px]",children:"chevron_right"})})]})]})]}),(0,r.jsx)("div",{className:"rounded-xl border border-border-dark bg-surface-dark overflow-hidden",children:(0,r.jsxs)(o.iA,{children:[(0,r.jsx)(o.xD,{className:"bg-[#1c1a11]",children:(0,r.jsxs)(o.SC,{className:"hover:bg-transparent border-border-dark",children:[(0,r.jsx)(o.ss,{className:"font-bold text-white",children:"User Info"}),(0,r.jsx)(o.ss,{className:"font-bold text-white",children:"Mobile"}),(0,r.jsx)(o.ss,{className:"font-bold text-white",children:"Wallet Balance"}),(0,r.jsx)(o.ss,{className:"font-bold text-white text-center",children:"Status"}),(0,r.jsx)(o.ss,{className:"font-bold text-white text-right",children:"Joined"}),(0,r.jsx)(o.ss,{className:"font-bold text-white text-right",children:"Actions"})]})}),(0,r.jsx)(o.RM,{children:t?(0,r.jsx)(o.SC,{children:(0,r.jsx)(o.pj,{colSpan:6,className:"text-center py-12 text-text-secondary",children:(0,r.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,r.jsx)("span",{className:"animate-spin material-symbols-outlined text-primary",children:"progress_activity"}),"Loading users..."]})})}):0===e.length?(0,r.jsx)(o.SC,{children:(0,r.jsx)(o.pj,{colSpan:6,className:"text-center py-12 text-text-secondary",children:"No users found matching your search."})}):e.map(e=>(0,r.jsxs)(o.SC,{className:"group hover:bg-white/5 border-border-dark",children:[(0,r.jsx)(o.pj,{className:"font-medium text-white",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"size-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs uppercase border border-primary/20",children:e.name.charAt(0)}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold",children:e.name}),e.is_verified&&(0,r.jsxs)("p",{className:"text-[10px] text-success flex items-center gap-0.5",children:[(0,r.jsx)("span",{className:"material-symbols-outlined text-[10px]",children:"verified"})," Verified"]})]})]})}),(0,r.jsx)(o.pj,{className:"text-text-secondary font-mono",children:e.mobile}),(0,r.jsx)(o.pj,{children:(0,r.jsxs)("span",{className:"font-bold text-primary",children:["₹ ",e.wallet_balance]})}),(0,r.jsx)(o.pj,{className:"text-center",children:(0,r.jsxs)("button",{onClick:()=>w(e._id,e.is_active),className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border transition-all ${e.is_active?"bg-success/10 text-success border-success/20 hover:bg-success/20":"bg-error/10 text-error border-error/20 hover:bg-error/20"}`,title:"Click to toggle status",children:[(0,r.jsx)("span",{className:`size-1.5 rounded-full ${e.is_active?"bg-success":"bg-error"}`}),e.is_active?"Active":"Blocked"]})}),(0,r.jsx)(o.pj,{className:"text-right text-text-secondary text-xs",children:new Date(e.createdAt).toLocaleDateString()}),(0,r.jsx)(o.pj,{className:"text-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1 opacity-60 group-hover:opacity-100 transition-opacity",children:[(0,r.jsx)(n.z,{variant:"ghost",size:"icon",className:"h-8 w-8 text-success hover:text-success hover:bg-success/10",title:"Add Funds",onClick:()=>{v(e),y(!0)},children:(0,r.jsx)("span",{className:"material-symbols-outlined text-[20px]",children:"account_balance_wallet"})}),(0,r.jsx)(n.z,{variant:"ghost",size:"icon",className:"h-8 w-8 text-primary hover:text-primary hover:bg-primary/10",title:"Edit User",children:(0,r.jsx)("span",{className:"material-symbols-outlined text-[18px]",children:"edit"})}),(0,r.jsx)(n.z,{variant:"ghost",size:"icon",className:"h-8 w-8 text-text-secondary hover:text-white hover:bg-white/10",title:"View History",children:(0,r.jsx)("span",{className:"material-symbols-outlined text-[18px]",children:"history"})})]})})]},e._id))})]})})]})}),(0,r.jsx)(m,{isOpen:N,onClose:()=>y(!1),user:f,onSuccess:k})]})]})}},2367:(e,s,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.r(s),t.d(s,{default:()=>e});var a=t(1909);let e=(await (0,a.createProxy)(String.raw`C:\Users\IronBeast\Desktop\Matka\Native Matka\apps\web\app\users\page.tsx`)).default;r()}catch(e){r(e)}},1)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[921,622,309,226,353],()=>t(1891));module.exports=r})();