(()=>{var e={};e.id=820,e.ids=[820],e.modules={1185:e=>{"use strict";e.exports=require("mongoose")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},6162:e=>{"use strict";e.exports=require("stream")},1764:e=>{"use strict";e.exports=require("util")},2161:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>m,serverHooks:()=>f,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>l,POST:()=>d});var n=r(5122),a=r(7868),i=r(9769),o=r(1929),u=r(8063),p=r(6264),c=r(6813);async function l(e){try{await (0,u.Z)();let e=(await p.Z.find({}).sort({createdAt:-1}).lean()).map(e=>{let t=function(e,t,r=[]){if(!e||!t)return!1;let s=new Date,n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][s.getDay()];if(r.length>0&&!r.includes(n))return!1;try{let r=60*s.getHours()+s.getMinutes(),n=e=>{let[t,r]=e.split(" "),[s,n]=t.split(":").map(Number);return"PM"===r&&12!==s&&(s+=12),"AM"===r&&12===s&&(s=0),60*s+n},a=n(e),i=n(t);if(a<i)return r>=a&&r<=i;return r>=a||r<=i}catch(e){return console.error("Error parsing market time",e),!1}}(e.open_time,e.close_time,e.days_open);return{...e,is_market_open:t,market_status:t?"open":"close"}});return o.NextResponse.json({success:!0,data:e})}catch(e){return o.NextResponse.json({success:!1,message:e.message},{status:500})}}async function d(e){try{await (0,u.Z)();try{(0,c.GJ)(e)}catch(e){return o.NextResponse.json({success:!1,message:"Unauthorized"},{status:403})}let t=await e.json(),r=await p.Z.create(t);return o.NextResponse.json({success:!0,message:"Market created",data:r},{status:201})}catch(e){return o.NextResponse.json({success:!1,message:e.message},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/markets/route",pathname:"/api/markets",filename:"route",bundlePath:"app/api/markets/route"},resolvedPagePath:"C:\\Users\\IronBeast\\Desktop\\Matka\\Native Matka\\apps\\web\\app\\api\\markets\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:g,workUnitAsyncStorage:y,serverHooks:f}=m;function h(){return(0,i.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:y})}},3245:()=>{},6813:(e,t,r)=>{"use strict";r.d(t,{GJ:()=>o,WX:()=>i});var s=r(8627),n=r.n(s);let a=process.env.JWT_SECRET||"default_secret_key_change_me",i=e=>{try{let t=e.headers.get("authorization")?.split(" ")[1];if(!t)return null;return n().verify(t,a)}catch(e){return null}},o=e=>{let t=i(e);if(!t||!t.is_admin)throw Error("Forbidden: Admin access only");return t}},8063:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(1185),n=r.n(s);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let o=async function(){if(i.conn)return i.conn;i.promise||(i.promise=n().connect(a,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}},6264:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var s=r(1185),n=r.n(s);let a=new s.Schema({name:{type:String,required:!0},start_time:{type:String,default:"12:00 AM"},open_time:{type:String,required:!0},close_time:{type:String,required:!0},is_active:{type:Boolean,default:!0},days_open:{type:[String],default:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},type:{type:String,enum:["main","starline","gali_disawar"],default:"main"},result:{open_panna:{type:String,default:"***"},close_panna:{type:String,default:"***"},open_digit:{type:String,default:"*"},close_digit:{type:String,default:"*"}},market_status:{type:String,enum:["open","close"],default:"open"}},{timestamps:!0}),i=n().models.Game||n().model("Game",a)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[921,999,627],()=>r(2161));module.exports=s})();